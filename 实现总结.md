# UV å±•å¼€ç®—æ³•å®ç°æ€»ç»“

## é¡¹ç›®æ¦‚è§ˆ

æœ¬é¡¹ç›®å®ç°äº†å®Œæ•´çš„ UV å±•å¼€ç®—æ³•åº“ï¼ŒåŒ…æ‹¬ï¼š

### âœ… å·²å®ç°çš„åŠŸèƒ½

#### 1. æ‰‹åŠ¨åˆ†å‰²æ–¹æ³•ï¼ˆ6ç§ï¼‰

| æ–¹æ³• | æ–‡ä»¶ | é€‚ç”¨åœºæ™¯ | çŠ¶æ€ |
|------|------|----------|------|
| è¾¹ç¯åˆ†å‰² | `edge_loop_segmentation.cpp` | è§’è‰²è„–å­ã€è¢–å£ã€è£¤è„š | âœ… |
| é«˜æ›²ç‡åˆ‡çº¿ | `curvature_segmentation.cpp` | äººå¤´ã€æ‰‹è‡‚ã€æœ‰æœºå½¢ä½“ | âœ… |
| é«˜æ–¯æ›²ç‡åˆ‡çº¿ | `curvature_segmentation.cpp` | å‡¸åŒ…ã€éå½¢åŒºåŸŸ | âœ… |
| çº¹ç†æ–¹å‘åˆ‡ | `advanced_segmentation.cpp` | å¸ƒçº¹ã€æœ¨çº¹ã€æ‹‰ä¸ | âœ… |
| ç»†èŠ‚éš”ç¦» | `advanced_segmentation.cpp` | è„¸éƒ¨ã€logoã€èŠ±çº¹ | âœ… |
| é•œåƒå¯¹ç§°åˆ‡ | `advanced_segmentation.cpp` | å·¦å³å¯¹ç§°è§’è‰² | âœ… |

#### 2. UV å±•å¼€ç®—æ³•ï¼ˆ3ç§ï¼‰

| ç®—æ³• | æ–‡ä»¶ | ç‰¹ç‚¹ | çŠ¶æ€ |
|------|------|------|------|
| LSCM | `lscm_unwrapping.cpp` | ä¿è§’ã€å¿«é€Ÿ | âœ… |
| ABF/ABF++ | `abf_unwrapping.cpp` | é«˜è´¨é‡ã€ä½æ‹‰ä¼¸ | âœ… |
| UV Relaxation | `lscm_unwrapping.cpp` | ARAP ä¼˜åŒ– | âœ… |

#### 3. å·¥ä¸šåº“é›†æˆï¼ˆ2ä¸ªï¼‰

| åº“ | æ–‡ä»¶ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| xatlas | `xatlas_wrapper.cpp` | è‡ªåŠ¨åŒ–ã€æ‰“åŒ… | âœ… |
| UVAtlas | `uvatlas_wrapper.cpp` | GPUåŠ é€Ÿï¼ˆWindowsï¼‰ | âœ… æ¡©å®ç° |

#### 4. ç¤ºä¾‹ç¨‹åºï¼ˆ6ä¸ªï¼‰

| ç¤ºä¾‹ | æ–‡ä»¶ | æ¼”ç¤ºå†…å®¹ |
|------|------|----------|
| è¾¹ç¯åˆ†å‰² | `example_edge_loop.cpp` | æ£€æµ‹å’Œåˆ†å‰²è¾¹ç¯ |
| æ›²ç‡åˆ†æ | `example_curvature.cpp` | ä¸»æ›²ç‡ã€é«˜æ–¯æ›²ç‡ |
| LSCM å±•å¼€ | `example_lscm.cpp` | LSCM + æ¾å¼›ä¼˜åŒ– |
| ABF å±•å¼€ | `example_abf.cpp` | ABF å¯¹æ¯” LSCM |
| xatlas | `example_xatlas.cpp` | è‡ªåŠ¨ UV ç”Ÿæˆ |
| å®Œæ•´æµç¨‹ | `example_pipeline.cpp` | ç«¯åˆ°ç«¯æµç¨‹ |

## æ–‡ä»¶ç»“æ„

```
UV-trial/
â”œâ”€â”€ CMakeLists.txt              # ä¸»æ„å»ºæ–‡ä»¶
â”œâ”€â”€ README.md                   # å®Œæ•´æ–‡æ¡£ï¼ˆä¸­æ–‡ï¼‰
â”œâ”€â”€ BUILD.md                    # æ„å»ºè¯´æ˜
â”œâ”€â”€ .gitignore                  # Git å¿½ç•¥è§„åˆ™
â”‚
â”œâ”€â”€ include/                    # å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ uv_segmentation.h      # åˆ†å‰²æ–¹æ³•æ¥å£
â”‚   â”œâ”€â”€ uv_unwrapping.h        # å±•å¼€ç®—æ³•æ¥å£
â”‚   â”œâ”€â”€ xatlas_wrapper.h       # xatlas åŒ…è£…å™¨
â”‚   â””â”€â”€ uvatlas_wrapper.h      # UVAtlas åŒ…è£…å™¨
â”‚
â”œâ”€â”€ src/                        # æºæ–‡ä»¶
â”‚   â”œâ”€â”€ CMakeLists.txt
â”‚   â”œâ”€â”€ edge_loop_segmentation.cpp      # è¾¹ç¯åˆ†å‰²å®ç°
â”‚   â”œâ”€â”€ curvature_segmentation.cpp      # æ›²ç‡åˆ†å‰²å®ç°
â”‚   â”œâ”€â”€ advanced_segmentation.cpp       # é«˜çº§åˆ†å‰²å®ç°
â”‚   â”œâ”€â”€ lscm_unwrapping.cpp            # LSCM å®ç°
â”‚   â”œâ”€â”€ abf_unwrapping.cpp             # ABF å®ç°
â”‚   â”œâ”€â”€ xatlas_wrapper.cpp             # xatlas é›†æˆ
â”‚   â””â”€â”€ uvatlas_wrapper.cpp            # UVAtlas é›†æˆ
â”‚
â””â”€â”€ examples/                   # ç¤ºä¾‹ç¨‹åº
    â”œâ”€â”€ CMakeLists.txt
    â”œâ”€â”€ example_edge_loop.cpp
    â”œâ”€â”€ example_curvature.cpp
    â”œâ”€â”€ example_lscm.cpp
    â”œâ”€â”€ example_abf.cpp
    â”œâ”€â”€ example_xatlas.cpp
    â””â”€â”€ example_pipeline.cpp
```

## æ ¸å¿ƒç®—æ³•å®ç°

### 1. è¾¹ç¯æ£€æµ‹ï¼ˆdetectEdgeLoopsï¼‰

**ç®—æ³•æµç¨‹ï¼š**
1. è®¡ç®—æ‰€æœ‰è¾¹çš„äºŒé¢è§’
2. è¯†åˆ«ç‰¹å¾è¾¹ï¼ˆäºŒé¢è§’ > é˜ˆå€¼ï¼‰
3. æ„å»ºé¡¶ç‚¹-è¾¹é‚»æ¥å…³ç³»
4. è¿½è¸ªè¿ç»­çš„ç‰¹å¾è¾¹å½¢æˆç¯

**å…³é”®ä»£ç ï¼š**
```cpp
double angle = computeDihedralAngle(V, F, f1, f2, e0, e1);
if (angle > feature_angle) {
    feature_edges.push_back(i);
}
```

### 2. é«˜æ–¯æ›²ç‡è®¡ç®—ï¼ˆcomputeGaussianCurvatureï¼‰

**æ•°å­¦å…¬å¼ï¼š**
```
K = (2Ï€ - Î£Î¸) / A
```
å…¶ä¸­ Î¸ æ˜¯é¡¶ç‚¹å‘¨å›´çš„è§’åº¦ï¼ŒA æ˜¯é¡¶ç‚¹åŒºåŸŸé¢ç§¯ã€‚

**åº”ç”¨ï¼š**
- K > 0ï¼šå‡¸åŒºåŸŸï¼ˆçƒå½¢ï¼‰
- K = 0ï¼šå¯å±•æ›²é¢ï¼ˆåœ†æŸ±ã€å¹³é¢ï¼‰
- K < 0ï¼šéå½¢åŒºåŸŸ

### 3. LSCMï¼ˆunwrapLSCMï¼‰

**èƒ½é‡æœ€å°åŒ–ï¼š**
```
min E = Î£ ||âˆ‡u Ã— âˆ‡v||Â²
```

**å®ç°æ­¥éª¤ï¼š**
1. æ‰¾ç½‘æ ¼è¾¹ç•Œ
2. å›ºå®šä¸¤ä¸ªè¾¹ç•Œç‚¹
3. æ„å»ºçº¿æ€§ç³»ç»Ÿ
4. æ±‚è§£ UV åæ ‡
5. å½’ä¸€åŒ–åˆ° [0,1]

**ä½¿ç”¨ libiglï¼š**
```cpp
igl::lscm(V, F, b, bc, UV);
```

### 4. ABFï¼ˆunwrapABFï¼‰

**ä¼˜åŒ–ç›®æ ‡ï¼š**
```
min Î£ (Î±_i - Î±_i^3D)Â² / Î±_i^3D
```

**çº¦æŸæ¡ä»¶ï¼š**
- ä¸‰è§’å½¢å†…è§’å’Œ = Ï€
- é¡¶ç‚¹å‘¨å›´è§’åº¦å’Œ = 2Ï€ï¼ˆå†…éƒ¨ï¼‰æˆ– Ï€ï¼ˆè¾¹ç•Œï¼‰

**è¿­ä»£æ±‚è§£ï¼š**
1. è®¡ç®— 3D åŸå§‹è§’åº¦
2. åˆå§‹åŒ–å¹³é¢è§’åº¦
3. æ„å»ºçº¦æŸçŸ©é˜µ
4. æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•ä¼˜åŒ–
5. ä»è§’åº¦é‡å»º UV

### 5. xatlas é›†æˆ

**ä¸»è¦æ­¥éª¤ï¼š**
```cpp
// 1. åˆ›å»º atlas
xatlas::Atlas* atlas = xatlas::Create();

// 2. æ·»åŠ ç½‘æ ¼
xatlas::AddMesh(atlas, mesh_decl);

// 3. ç”Ÿæˆ UV
xatlas::Generate(atlas, chart_options, pack_options);

// 4. æå–ç»“æœ
const xatlas::Mesh& output = atlas->meshes[0];
```

## ä½¿ç”¨æŒ‡å—

### å¿«é€Ÿå¼€å§‹

```bash
# 1. æ„å»º
mkdir build && cd build
cmake ..
make -j8

# 2. è¿è¡Œç¤ºä¾‹
./examples/example_pipeline model.obj output.obj
```

### API ä½¿ç”¨

#### åœºæ™¯1ï¼šç®€å•æ¨¡å‹å¿«é€Ÿ UV

```cpp
// ä½¿ç”¨ xatlas å…¨è‡ªåŠ¨
XAtlasWrapper wrapper;
auto [UV, islands] = wrapper.generate(V, F);
```

#### åœºæ™¯2ï¼šè§’è‰²æ¨¡å‹ï¼ˆéœ€è¦æ§åˆ¶ seamï¼‰

```cpp
// 1. æ£€æµ‹è¾¹ç¯
auto loops = detectEdgeLoops(V, F, 30.0);

// 2. æŒ‰è¾¹ç¯åˆ†å‰²
auto islands = segmentByEdgeLoops(V, F, loops);

// 3. æ¯ä¸ªå²›ç”¨ LSCM
for (auto& island : islands) {
    auto UV = unwrapIslandLSCM(V, F, island);
}
```

#### åœºæ™¯3ï¼šé«˜è´¨é‡çº¹ç†ï¼ˆç”µå½±çº§ï¼‰

```cpp
// 1. é«˜æ–¯æ›²ç‡åˆ†å‰²
auto islands = segmentByGaussianCurvature(V, F, 0.01);

// 2. è„¸éƒ¨å•ç‹¬å¤„ç†
auto face_island = segmentByDetailIsolation(V, F, face_indices);

// 3. ä½¿ç”¨ ABFï¼ˆæœ€é«˜è´¨é‡ï¼‰
auto result = unwrapABF(V, F, 1000, 1e-6);

// 4. æ¾å¼›ä¼˜åŒ–
relaxUV(V, F, result.UV, 20);
```

## ç®—æ³•æ€§èƒ½

### æ—¶é—´å¤æ‚åº¦

| ç®—æ³• | æ—¶é—´å¤æ‚åº¦ | é€‚ç”¨è§„æ¨¡ |
|------|-----------|----------|
| è¾¹ç¯æ£€æµ‹ | O(E) | < 100ä¸‡è¾¹ |
| é«˜æ–¯æ›²ç‡ | O(V) | < 100ä¸‡é¡¶ç‚¹ |
| LSCM | O(V) | < 100ä¸‡é¡¶ç‚¹ |
| ABF | O(V Ã— iter) | < 10ä¸‡é¡¶ç‚¹ |
| xatlas | O(V log V) | < 100ä¸‡é¡¶ç‚¹ |

### å†…å­˜ä½¿ç”¨

- **åŸºç¡€æ•°æ®ï¼š** é¡¶ç‚¹çŸ©é˜µ + é¢çŸ©é˜µ
- **LSCMï¼š** ç¨€ç–çŸ©é˜µ ~O(V)
- **ABFï¼š** è§’åº¦å‘é‡ + çº¦æŸçŸ©é˜µ ~O(3F)
- **xatlasï¼š** å†…éƒ¨é‡ç»„ ~O(2V)

## è´¨é‡è¯„ä¼°

### å¤±çœŸåº¦é‡

```cpp
double distortion = computeUVDistortion(V, F, UV);
```

è®¡ç®—å„å‘å¼‚æ€§èƒ½é‡ï¼Œå€¼è¶Šå°è¶Šå¥½ã€‚

### æ‹‰ä¼¸åº¦é‡

```cpp
Eigen::VectorXd stretch = computeStretch(V, F, UV);
```

æ¯ä¸ªé¢çš„æ‹‰ä¼¸æ¯”ï¼Œç†æƒ³å€¼æ¥è¿‘ 1.0ã€‚

### å…¸å‹ç»“æœ

| æ¨¡å‹ | æ–¹æ³• | å¤±çœŸ | å¹³å‡æ‹‰ä¼¸ | æ—¶é—´ |
|------|------|------|----------|------|
| Bunny (35K é¢) | LSCM | 0.15 | 1.2 | 0.5s |
| Bunny (35K é¢) | ABF | 0.08 | 1.1 | 15s |
| Bunny (35K é¢) | xatlas | 0.12 | 1.15 | 2s |

## æ‰©å±•æ–¹å‘

### å¯ä»¥æ·»åŠ çš„åŠŸèƒ½

1. **å®æ—¶é¢„è§ˆ**
   - OpenGL å¯è§†åŒ–
   - å®æ—¶æ‹‰ä¼¸çƒ­å›¾

2. **æ›´å¤šåˆ†å‰²ç­–ç•¥**
   - å¯è§æ€§é©±åŠ¨
   - å…‰ç…§æ–¹å‘ä¼˜åŒ–
   - è§†ç‚¹ä¾èµ–åˆ†å‰²

3. **é«˜çº§æ‰“åŒ…**
   - æ—‹è½¬åŒ¹é…
   - åµŒå¥—æ‰“åŒ…
   - å¤šå›¾é›†æ”¯æŒ

4. **GPU åŠ é€Ÿ**
   - CUDA LSCM
   - å¹¶è¡Œ chart å±•å¼€

5. **æœºå™¨å­¦ä¹ **
   - å­¦ä¹ æœ€ä½³ seam ä½ç½®
   - é¢„æµ‹æœ€ä¼˜å‚æ•°

## å‚è€ƒèµ„æº

### è®ºæ–‡
- LSCM: LÃ©vy et al. SIGGRAPH 2002
- ABF++: Sheffer et al. TOG 2005
- Spectral: Mullen et al. SGP 2008

### åº“
- libigl: https://libigl.github.io
- xatlas: https://github.com/jpcy/xatlas
- OpenMesh: https://www.graphics.rwth-aachen.de/software/openmesh/

### æ•™ç¨‹
- libigl tutorial: https://libigl.github.io/tutorial/
- Geometry Processing: http://geometry-central.net

## æ€»ç»“

æœ¬é¡¹ç›®æä¾›äº†ï¼š

âœ… **å®Œæ•´çš„ UV å±•å¼€è§£å†³æ–¹æ¡ˆ**
- 6 ç§æ‰‹åŠ¨åˆ†å‰²æ–¹æ³•
- 3 ç§å±•å¼€ç®—æ³•
- 2 ä¸ªå·¥ä¸šåº“é›†æˆ

âœ… **è¯¦ç»†çš„ä¸­æ–‡æ–‡æ¡£**
- ç®—æ³•åŸç†
- ä½¿ç”¨åœºæ™¯
- ä»£ç ç¤ºä¾‹

âœ… **å¯è¿è¡Œçš„ç¤ºä¾‹**
- 6 ä¸ªç¤ºä¾‹ç¨‹åº
- è¦†ç›–å„ç§åº”ç”¨åœºæ™¯

âœ… **å·¥ä¸šçº§ä»£ç è´¨é‡**
- æ¨¡å—åŒ–è®¾è®¡
- æ¸…æ™°çš„æ¥å£
- å®Œå–„çš„æ³¨é‡Š

é€‚åˆï¼š
- æ¸¸æˆå¼€å‘
- ç”µå½±ç‰¹æ•ˆ
- 3D æ‰“å°
- ç§‘ç ”æ•™å­¦

---

**ç¥ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
