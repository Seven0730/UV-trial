# Heat Method å®ç°æ€»ç»“

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. Heat Method æ ¸å¿ƒç®—æ³•

- âœ… é›†æˆ geometry-processing-js åº“
- âœ… å®ç°å®Œæ•´çš„ Heat Method è·ç¦»åœºè®¡ç®—
- âœ… å®ç°æ¢¯åº¦ä¸‹é™è·¯å¾„è¿½è¸ªç®—æ³•
- âœ… æ”¯æŒä»æºç‚¹åˆ°ç›®æ ‡ç‚¹çš„æœ€çŸ­æµ‹åœ°çº¿è®¡ç®—

### 2. Web Worker å¼‚æ­¥æ¶æ„

- âœ… ç‹¬ç«‹çš„ Worker çº¿ç¨‹è¿›è¡Œå‡ ä½•è®¡ç®—
- âœ… æ¶ˆæ¯é€šä¿¡æœºåˆ¶ï¼ˆè¯·æ±‚/å“åº”æ¨¡å¼ï¼‰
- âœ… Transferable å¯¹è±¡ä¼˜åŒ–ï¼ˆé›¶æ‹·è´ä¼ è¾“ï¼‰
- âœ… é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç®¡ç†

### 3. å¯è§†åŒ–ç³»ç»Ÿ

- âœ… **TubeGeometry ç®¡çŠ¶è·¯å¾„æ¸²æŸ“**
  - ä½¿ç”¨ CatmullRomCurve3 å¹³æ»‘æ’å€¼
  - å¯é…ç½®åŠå¾„å’Œæ®µæ•°
  - çº¢è‰²å‘å…‰æè´¨
  
- âœ… **æ·±åº¦åç§»ï¼ˆPolygon Offsetï¼‰**
  - `polygonOffsetFactor: -1`
  - `polygonOffsetUnits: -1`
  - `renderOrder: 1`
  - å®Œç¾é¿å… Z-Fighting

### 4. äº¤äº’å¼ç”¨æˆ·ç•Œé¢

- âœ… Shift + å•å‡»æ·»åŠ æ§åˆ¶ç‚¹
- âœ… è‡ªåŠ¨æ‰¾åˆ°æœ€è¿‘é¡¶ç‚¹ï¼ˆé‡å¿ƒåæ ‡æ³•ï¼‰
- âœ… ç›¸é‚»ç‚¹è‡ªåŠ¨è®¡ç®—æµ‹åœ°çº¿
- âœ… å¤šæ®µè·¯å¾„è‡ªåŠ¨åˆå¹¶
- âœ… æ’¤é”€ã€ç»“æŸã€å¯¼å‡ºåŠŸèƒ½
- âœ… å®æ—¶çŠ¶æ€æ˜¾ç¤º

### 5. å‡ ä½•å¤„ç†

- âœ… OBJ æ¨¡å‹åŠ è½½
- âœ… æ‹–æ‹½å¯¼å…¥æ”¯æŒ
- âœ… ç½‘æ ¼æ•°æ®æå–å’Œè½¬æ¢
- âœ… é¡¶ç‚¹/ç´¢å¼•ç¼“å†²åŒºç®¡ç†
- âœ… é‡å¿ƒåæ ‡è®¡ç®—
- âœ… Raycasting æ‹¾å–

## ğŸ“Š æŠ€æœ¯æŒ‡æ ‡

### æ€§èƒ½

- **åˆå§‹åŒ–æ—¶é—´**ï¼šçº¦ 100-500msï¼ˆå–å†³äºæ¨¡å‹å¤æ‚åº¦ï¼‰
- **å•æ¬¡æŸ¥è¯¢**ï¼šçº¦ 50-200msï¼ˆå–å†³äºæ¨¡å‹å¤§å°ï¼‰
- **å†…å­˜å ç”¨**ï¼šä¼˜åŒ–çš„ Typed Arrays
- **å¹¶å‘å¤„ç†**ï¼šWeb Worker ç‹¬ç«‹çº¿ç¨‹

### å‡†ç¡®æ€§

- **è·ç¦»åœºç²¾åº¦**ï¼šä¾èµ–äºç½‘æ ¼åˆ†è¾¨ç‡
- **è·¯å¾„å¹³æ»‘åº¦**ï¼šä½¿ç”¨ Catmull-Rom æ ·æ¡æ’å€¼
- **æ•°å€¼ç¨³å®šæ€§**ï¼šä½¿ç”¨ Cholesky åˆ†è§£æ±‚è§£ç¨€ç–çº¿æ€§ç³»ç»Ÿ

### å…¼å®¹æ€§

- âœ… ç°ä»£æµè§ˆå™¨ï¼ˆæ”¯æŒ Web Workers å’Œ ES Modulesï¼‰
- âœ… Three.js r161+
- âœ… TypeScript 5.4+
- âœ… Vite 5.1+

## ğŸ¯ å®ç°äº®ç‚¹

### 1. ç®—æ³•ä¼˜åŠ¿

**Heat Method çš„ä¼˜åŠ¿**ï¼š
- åªéœ€æ±‚è§£ç¨€ç–çº¿æ€§æ–¹ç¨‹ç»„ï¼ˆæ¯” Dijkstra æ›´é«˜æ•ˆï¼‰
- é¢„è®¡ç®—çŸ©é˜µåˆ†è§£åæŸ¥è¯¢é€Ÿåº¦æå¿«
- å¯¹ç½‘æ ¼è´¨é‡ä¸æ•æ„Ÿ
- ç”Ÿæˆçš„è·¯å¾„è‡ªç„¶å¹³æ»‘

**è·¯å¾„è¿½è¸ªä¼˜åŒ–**ï¼š
- è´ªå¿ƒæ¢¯åº¦ä¸‹é™ç­–ç•¥
- é‚»æ¥å›¾éå†
- é˜²æ­¢æ— é™å¾ªç¯ä¿æŠ¤
- è‡ªåŠ¨è·³è¿‡é‡å¤é¡¶ç‚¹

### 2. å·¥ç¨‹å®è·µ

**æ¨¡å—åŒ–è®¾è®¡**ï¼š
```
HeatSolver (ç®—æ³•å±‚)
    â†“
HeatWorker (é€šä¿¡å±‚)
    â†“
Main Thread (åº”ç”¨å±‚)
```

**ç±»å‹å®‰å…¨**ï¼š
- å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
- æ¥å£è§„èŒƒï¼ˆMessageã€Responseã€Resultï¼‰
- ç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥

**é”™è¯¯å¤„ç†**ï¼š
- Worker å¼‚å¸¸æ•è·
- Promise é”™è¯¯ä¼ æ’­
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

### 3. å¯è§†åŒ–åˆ›æ–°

**ç®¡çŠ¶è·¯å¾„çš„ä¼˜åŠ¿**ï¼š
- æ¯”å¹³é¢çº¿æ¡æ›´æœ‰ç«‹ä½“æ„Ÿ
- æ˜“äºè¯†åˆ«å’Œé€‰æ‹©
- æ”¯æŒè‡ªå®šä¹‰åŠå¾„
- å¯ä»¥æ·»åŠ é˜´å½±å’Œå…‰ç…§æ•ˆæœ

**æ·±åº¦åç§»æŠ€æœ¯**ï¼š
- å®Œç¾è§£å†³ Z-Fighting é—®é¢˜
- ä¸æ”¹å˜å‡ ä½•å½¢çŠ¶
- æ€§èƒ½å¼€é”€æå°
- è§†è§‰æ•ˆæœè‡ªç„¶

## ğŸ“ æ–‡ä»¶ç»“æ„

```plaintext
web/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                    # ä¸»åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ style.css                  # æ ·å¼
â”‚   â”œâ”€â”€ workers/
â”‚   â”‚   â”œâ”€â”€ heatWorker.ts         # Worker ä¸»çº¿ç¨‹
â”‚   â”‚   â”œâ”€â”€ heatSolver.ts         # Heat Method æ±‚è§£å™¨
â”‚   â”‚   â””â”€â”€ types.ts              # æ¶ˆæ¯ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â””â”€â”€ segmentation/
â”‚   â”‚       â”œâ”€â”€ pathRenderer.ts   # è·¯å¾„æ¸²æŸ“å™¨
â”‚   â”‚       â”œâ”€â”€ store.ts          # çŠ¶æ€ç®¡ç†
â”‚   â”‚       â”œâ”€â”€ types.ts          # æ•°æ®ç±»å‹
â”‚   â”‚       â”œâ”€â”€ linePreview.ts    # é¢„è§ˆçº¿
â”‚   â”‚       â””â”€â”€ raycast.ts        # å°„çº¿æ‹¾å–
â”‚   â””â”€â”€ core/
â”‚       â””â”€â”€ three/
â”‚           â”œâ”€â”€ scene.ts          # Three.js åœºæ™¯
â”‚           â”œâ”€â”€ loaders.ts        # æ¨¡å‹åŠ è½½
â”‚           â””â”€â”€ helpers.ts        # å·¥å…·å‡½æ•°
â”œâ”€â”€ vendor/
â”‚   â””â”€â”€ geometry-processing-js/   # å‡ ä½•å¤„ç†åº“
â”œâ”€â”€ public/
â”‚   â””â”€â”€ obj/                      # æµ‹è¯•æ¨¡å‹
â”œâ”€â”€ IMPLEMENTATION.md             # å®ç°æ–‡æ¡£
â”œâ”€â”€ USAGE.md                      # ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â””â”€â”€ tsconfig.json
```

## ğŸ”¬ å…³é”®ä»£ç ç‰‡æ®µ

### Heat Method æ ¸å¿ƒ

```typescript
// è®¡ç®—è·ç¦»åœº
const heat = new this.HeatMethod(this.geometry);
const phi: DenseMatrix = heat.compute(delta);

// è·¯å¾„è¿½è¸ª
while (current !== source) {
  for (const neighbor of vertex.adjacentVertices()) {
    if (distances[neighbor] < minDist) {
      minDist = distances[neighbor];
      nextVertex = neighbor;
    }
  }
  path.push(nextVertex);
  current = nextVertex;
}
```

### ç®¡çŠ¶æ¸²æŸ“

```typescript
const curve = new THREE.CatmullRomCurve3(points, false, "centripetal");
const tubeGeo = new THREE.TubeGeometry(curve, tubularSegments, radius, 8);
const material = new THREE.MeshStandardMaterial({
  color: 0xff5c5c,
  polygonOffset: true,
  polygonOffsetFactor: -1,
  polygonOffsetUnits: -1,
});
```

## ğŸš€ ä¸‹ä¸€æ­¥æ”¹è¿›

### çŸ­æœŸä¼˜åŒ–

1. **æ€§èƒ½ä¼˜åŒ–**
   - [ ] æ·»åŠ è·ç¦»åœºç¼“å­˜
   - [ ] å®ç°æ¸è¿›å¼æ¸²æŸ“
   - [ ] ä¼˜åŒ–å†…å­˜ä½¿ç”¨

2. **åŠŸèƒ½å¢å¼º**
   - [ ] æ”¯æŒè·ç¦»åœºå¯è§†åŒ–ï¼ˆé¢œè‰²æ˜ å°„ï¼‰
   - [ ] æ·»åŠ è·¯å¾„ç¼–è¾‘åŠŸèƒ½
   - [ ] æ”¯æŒæ‰¹é‡è®¡ç®—å¤šæ¡è·¯å¾„

### é•¿æœŸè§„åˆ’

1. **ç®—æ³•æ‰©å±•**
   - [ ] å®ç°å¤šæºæœ€çŸ­è·¯å¾„
   - [ ] æ”¯æŒè¾¹ç•Œçº¦æŸçš„æµ‹åœ°çº¿
   - [ ] æ·»åŠ å„å‘å¼‚æ€§è·ç¦»åº¦é‡

2. **åº”ç”¨åœºæ™¯**
   - [ ] UV å±•å¼€è£çº¿ç”Ÿæˆ
   - [ ] ç½‘æ ¼åˆ†å‰²å·¥å…·
   - [ ] æ›²é¢æµ‹é‡å·¥å…·

## ğŸ“š å‚è€ƒèµ„æ–™

- [The Heat Method Paper](http://www.cs.cmu.edu/~kmcrane/Projects/HeatMethod/)
- [geometry-processing-js](https://github.com/GeometryCollective/geometry-processing-js)
- [Three.js TubeGeometry](https://threejs.org/docs/#api/en/geometries/TubeGeometry)
- [Polygon Offset](https://www.khronos.org/opengl/wiki/Vertex_Post-Processing#Polygon_offset)

## ğŸ† æˆæœå±•ç¤º

### ç®—æ³•å®ç°

- âœ… å®Œæ•´å®ç° Heat Method å››æ­¥ç®—æ³•
- âœ… æ¢¯åº¦ä¸‹é™è·¯å¾„è¿½è¸ª
- âœ… Web Worker å¼‚æ­¥è®¡ç®—æ¶æ„

### å¯è§†åŒ–æ•ˆæœ

- âœ… å¹³æ»‘çš„ç®¡çŠ¶è·¯å¾„
- âœ… æ—  Z-Fighting é—®é¢˜
- âœ… é«˜è´¨é‡æè´¨æ¸²æŸ“

### ç”¨æˆ·ä½“éªŒ

- âœ… ç›´è§‚çš„äº¤äº’æ–¹å¼
- âœ… å®æ—¶åé¦ˆ
- âœ… å®Œæ•´çš„æ“ä½œæµç¨‹

---

**å®ç°æ—¥æœŸ**ï¼š2025å¹´12æœˆ  
**å®ç°è€…**ï¼šGitHub Copilot  
**ç®—æ³•æ¥æº**ï¼šKeenan Crane et al., "The Heat Method for Distance Computation"
