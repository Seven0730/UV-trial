# 快速使用指南

## 启动应用

```bash
cd web
npm install    # 首次运行需要
npm run dev    # 启动开发服务器
```

浏览器访问：<http://localhost:4174>

## 基本操作

### 1. 加载模型

- 点击 **"加载默认 OBJ"** 加载测试模型
- 或者直接拖拽 `.obj` 文件到窗口

### 2. 创建测地线

1. 点击 **"新建线"** 按钮开始新的线段
2. **Shift + 单击** 模型表面添加第一个点
3. 继续 **Shift + 单击** 添加更多点
   - 程序会自动计算相邻点之间的测地线路径
   - 红色管状线条即为计算出的测地线

### 3. 编辑线段

- **"撤销一点"** - 删除当前线段的最后一个点
- **"结束线"** - 完成当前线段，准备创建下一条
- **"导出 JSON"** - 导出所有线段数据

## 视图操作

- **左键拖拽** - 旋转视图
- **右键拖拽** - 平移视图
- **滚轮** - 缩放视图

## 注意事项

⚠️ **必须按住 Shift** 才能在模型上添加控制点，这是为了避免干扰视图旋转操作。

## 算法说明

### Heat Method 工作原理

每次添加新点时，程序会：

1. **热扩散** - 从上一个点开始模拟短时热扩散
2. **梯度归一化** - 计算热场梯度并归一化
3. **泊松求解** - 恢复距离场
4. **路径追踪** - 沿负梯度方向追踪最短路径

### 为什么选择 Heat Method？

- ⚡ **极快的速度** - 只需求解稀疏线性方程组
- 📏 **准确的距离** - 逼近真实的测地线距离
- 🎨 **平滑的路径** - 不受网格质量影响
- 🔄 **可重复使用** - 预计算后可多次查询

## 性能提示

- **大型模型**：首次加载时会初始化 Heat Method 求解器，可能需要几秒钟
- **多点路径**：每添加一个点都会触发一次计算，复杂模型可能有轻微延迟
- **状态显示**：底部左侧显示当前操作状态，右侧显示线段统计

## 故障排除

### 加载模型后无法添加点

- 检查是否按住了 **Shift** 键
- 等待状态栏显示"模型加载成功"

### 测地线计算失败

- 检查浏览器控制台是否有错误信息
- 确保模型是有效的三角网格
- 尝试重新加载页面

### 线条不可见

- 检查是否点击了"新建线"按钮
- 确保添加了至少两个点
- 尝试缩放和旋转视图找到线条

## 示例工作流程

```
1. 加载默认 OBJ ✅
2. 新建线 ✅
3. Shift + 单击添加第一个点 ✅
4. Shift + 单击添加第二个点 → 自动生成测地线 🔥
5. Shift + 单击添加第三个点 → 扩展测地线 🔥
6. 结束线 ✅
7. 新建线 → 开始下一条 ✅
8. 导出 JSON → 保存数据 💾
```

## 高级用法

### 批量处理

如果需要批量计算测地线，可以使用 C++ 版本的命令行工具：

```bash
cd ../build/examples
./example_geodesic model.obj source_vertex target_vertex output.json
```

### 自定义配置

编辑 `web/src/main.ts` 可以调整：
- 默认模型路径 (`DEFAULT_OBJ_URL`)
- 管状线条半径
- 颜色和材质参数

---

享受测地线计算的乐趣！🎯
